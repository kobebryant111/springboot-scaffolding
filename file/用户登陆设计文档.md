# 用户登陆设计文档

本文档旨在详细描述用户登录功能的设计，包括数据库表结构和功能设计。本功能允许用户通过用户名和密码进行身份验证，并访问系统。

#### 1. 功能需求

- **用户认证**：用户应能通过输入用户名和密码进行登录。
- **安全性**：密码应以加密形式存储，确保安全性。
- **错误处理**：系统应能处理并反馈登录过程中可能出现的错误，如“用户名不存在”或“密码错误”。
- **会话管理**：登录成功后，系统应生成会话（session）以保持用户状态。

#### 2. 表结构设计

##### 用户表（Users）

|    字段名     |    数据类型     |               描述               |
| :-----------: | :-------------: | :------------------------------: |
|      id       | INT PRIMARY KEY |      用户的唯一标识符，自增      |
|   username    |  VARCHAR(255)   |           用户名，唯一           |
| password_hash |  VARCHAR(255)   |         存储加密后的密码         |
|     email     |  VARCHAR(255)   | 用户的电子邮件，可用于密码找回等 |
|  last_login   |    DATETIME     |         最后一次登录时间         |
|   is_active   |     BOOLEAN     |           账户是否激活           |

**注意**：密码不应以明文形式存储，而应使用哈希算法（例如 bcrypt）进行加密。

#### 3. 功能设计

##### 登录流程

1. **用户输入**：
   - 用户输入用户名和密码。
   - 系统检查输入字段是否为空，若为空，则返回错误信息。
2. **验证过程**：
   - 系统根据输入的用户名查询用户表。
   - 如果未找到用户名，返回“用户名不存在”错误。
   - 如果用户名存在，系统将输入的密码与数据库中存储的哈希密码进行比对。
   - 如果密码不匹配，返回“密码错误”错误。
3. **会话创建**：
   - 如果用户名和密码验证成功，系统生成新的会话ID，并更新用户的`last_login`时间戳。
   - 系统将用户重定向到主页或用户仪表板。